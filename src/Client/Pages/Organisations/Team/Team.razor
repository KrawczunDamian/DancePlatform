@page "/organisations/team/{teamId:int}"
@attribute [Authorize(Policy = Permissions.Teams.View)]
@inject Microsoft.Extensions.Localization.IStringLocalizer<Teams> _localizer
@using DancePlatform.Application.Features.Teams.Queries.GetById

<style>
    .mud-table-container {
        overflow: auto;
    }
</style>


@if (!_loaded)
{
    <MudProgressCircular Color="Color.Primary" Indeterminate="true" />
}
else
{
    <MudContainer Fixed="true">
        <MudGrid Spacing="0">
            <MudItem xs="3" Style="max-width:200px">
                <MudPaper Class="pa-2 justify-center" Square="true"><BigTitle Title="@_localizer["Team"]" /></MudPaper>
                <MudPaper Class="pa-2" Square="true">
                    <MudContainer Class="pa-2">
                        <div class="d-flex justify-center" style="width:100%">
                            @if (!string.IsNullOrEmpty(@ImageDataUrl))
                            {
                                @*<MudAvatar Image="@ImageDataUrl" Style="max-width:100%;height=auto"> </MudAvatar>*@
                                <div class="mud-avatar mud-avatar-filled mud-avatar-filled-default" style="max-width:100%;height:auto">
                                    <img src="Files\Images\TeamProfilePictures\1-d47087bf-4884-4593-820b-2968c858d6f0.png" class="mud-avatar-img">
                                </div>
                            }
                            else
                            {

                                <MudAvatar Color="Color.Secondary" Style="max-width:100%;width:400px;height:unset;aspect-ratio:1/1">@_firstLetterOfName</MudAvatar>
                            }
                        </div>
                        <MudText Class="d-flex justify-center ma-2" Style="font-weight:bold">@_team.Name</MudText>
                        <MudText Class="d-flex justify-center ma-2"><MudIcon Icon="@Icons.Filled.Smartphone"></MudIcon> @(_team.PhoneNumber == null ? "-" : _team.PhoneNumber) </MudText>
                        <InputFile id="fileInput" OnChange="UploadFiles" hidden />
                        <MudButton HtmlTag="label"
                               Variant="Variant.Text"
                               Color="Color.Primary"
                               Size="Size.Small"
                               StartIcon="@Icons.Filled.CloudUpload"
                               for="fileInput"
                               Class="d-flex justify-center ma-2">
                            @_localizer["Upload Image"]
                        </MudButton>
                    </MudContainer>
                </MudPaper>
                <MudPaper Class="pa-2" Square="true">
                    <MudGrid Spacing="1" Class="align-center">
                        <MudItem Class="ma-3" xs="12">
                            <MiniTitle Title="@_localizer["Description"]" />
                            <MudText>
                                @_team.Description
                            </MudText>
                        </MudItem>
                        <MudItem Class="ma-3">
                            <MiniTitle Title="@_localizer["Country"]" />
                            <MudText>@_team.Country</MudText>
                        </MudItem>
                        <MudItem Class="ma-3">
                            <MiniTitle Title="@_localizer["City"]" />
                            <MudText>@_team.City</MudText>
                        </MudItem>
                    </MudGrid>
                </MudPaper>
            </MudItem>

            <MudItem xs="8">
                <MudPaper Square="true">
                    <MudPaper Class="pa-2" Square="true">
                        <MudText Typo="Typo.h4" Color="Color.Primary">Photos@*LOCALIZER*@</MudText>
                    </MudPaper>
                    <MudPaper Class="pa-2" Square="true">
                        <MudText Class="d-inline" Typo="Typo.h4" Color="Color.Primary">Members@*LOCALIZER*@</MudText>
                        <MudButton Style="float: right" DisableElevation Variant="Variant.Filled" Color="Color.Primary" OnClick="@((e) => AddMember())" StartIcon="@Icons.Material.Filled.Add" IconColor="Color.Surface">@_localizer["Add Member"]</MudButton>
                        <MudDivider></MudDivider>
                        @if(_teamMembers.Count > 0)
                        {
                        <MudCarousel ItemsSource="_teamMembers" Style="height:200px">
                            <ItemTemplate>
                                <div class="d-flex flex-column flex-column justify-center" style="height:100%">
                                    <MudText Align="@Align.Center" Class="mx-auto">@context.Nickname</MudText>
                                </div>
                            </ItemTemplate>
                        </MudCarousel>
                        }
                        else{
                            
                            <MudGrid Class="align-center">
                                <MudItem>
                            <MiniTitle Title="@_localizer["No Members"]"/>
                                </MudItem>
                            </MudGrid>
                        }
                    </MudPaper>
                </MudPaper>
            </MudItem>
        </MudGrid>
    </MudContainer>
}